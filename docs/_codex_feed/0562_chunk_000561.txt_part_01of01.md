# File: chunk_000561.txt (part 1 of 1)
```
in modulus 1 X i KM index (Range 00-FF) 16*n X eKMi(PK) or eKMi(SK) DEA CBC Enciphered DEA 2 key. Either the public key or the private key. Each SCM function implicitly requires keyblocks in a predetermined format. In an SCM Spec function, the key specifier is preceded by a length prefix, which adds one or more bytes to each of the above formats. The value of the length prefix does not include its own length. It is not necessary to store or transmit the length prefix, as its value is implied by the format code. The lengths of each of the above key specifiers are as follows: Length Format code Key specifier 21 DEA CBC Enciphered key - 128-bit with KM index 18 23 DEA ECB Enciphered key - 128-bit with KM index 17 31 DEA CBC Enciphered key - 128-bit 16n + 2 41 Cleartext DEA 2 public key - n 8-byte blocks 16n + 3 42 DEA CBC Enciphered DEA 2 key - n 8-byte blocks IAC CODE SET VOLUME 4 - DEVICE REQUIREMENTS AND CRYPTOGRAPHIC MANAGEMENT ANNEXURE F. INTRODUCTION TO DEVICE SUPPORT AND SCM FUNCTIONALITY Australian Payments Network Limited [ABN 12 055 136 519] 30 The following figures reflect the different way of representing key variants in the AMB and SCM Spec specifications. SCM Spec function specifications represent the repeated byte of each hexadecimal variant constant, as shown below: AMB variant SCM Spec variant variant constant for ECB-enciphered keys variant constant for CBC-enciphered keys (SCM Spec) V1 V24 24242424242424242424242424242424 24C024C024C024C024C024C024C024C0 V2 V28 28282828282828282828282828282828 28C028C028C028C028C028C028C028C0 V3 V22 22222222222222222222222222222222 22C022C022C022C022C022C022C022C0 V4 V48 48484848484848484848484848484848 48C048C048C048C048C048C048C048C0 V5 V42 42424242424242424242424242424242 42C042C042C042C042C042C042C042C0 V6 V44 44444444444444444444444444444444 44C044C044C044C044C044C044C044C0 V7 V82 82828282828282828282828282828282 82C082C082C082C082C082C082C082C0 V8 V84 84848484848484848484848484848484 84C084C084C084C084C084C084C084C0 N/A VA0 A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0A0 A0C0A0C0A0C0A0C0A0C0A0C0A0C0A0C0 V10 VAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAC0AAC0AAC0AAC0AAC0AAC0AAC0AAC0 N/A VAC ACACACACACACACACACACACACACACACAC ACC0ACC0ACC0ACC0ACC0ACC0ACC0ACC0 In subsequent figures, a box such as 21 in front of a key indicates the key specifier format. F.5 ATM Terminal - 3DES AusPayNet have defined an ATM 3DES solution that matches to the NCR ATM NDC+ 3DES specifications. Accordingly the following sections are based on this solution. For remote initialisation, three RSA key pairs are used. The modulus of each key pair is 2048 bits in size: • The manufacturer’s key (SK-NCR, PK-NCR); • The host’s key (SK-HSM, PK-HSM); • The Encrypting PIN pad’s key (SK-EPP, PK-EPP). Signatures are created by signing a hash of the target key or data, allowing all of the above keys to be the same size (unlike RSA keys for POS - see F.6). NCR nomenclature for RSA key usage is as follows: • (key) * SKsignature of key (or data) with secret key; • [key] PK encryption of key (or data) with public key. IAC CODE SET VOLUME 4 - DEVICE REQUIREMENTS AND CRYPTOGRAPHIC MANAGEMENT ANNEXURE F. INTRODUCTION TO DEVICE SUPPORT AND SCM FUNCTIONALITY Australian Payments Network Limited [ABN 12 055 136 519] 31 F.5.1 Exchange of Public Keys between Manufacturer and Host Host APCA2000 GETDEA2PAIR C620 42 eKMVA0(SK-HSM) PK-HSM 41 PK-HSM Secure offline message ATM Manufacturer (NCR) PK-NCR PK-HSM PK-NCR Secure offline message PK-NCR (PK-HSM) * SK-NCR SK-NCR (PK-HSM) * SK-NCR Sign 41 Figure 1 Exchange of RSA Public Keys between ATM Manufacturer and Host This is a one-off offline procedure, which precedes installation of any of the manufacturer’s Encrypting PIN Pads on the host’s network. The keys exchanged will be used in common for all ATMs on the network (unless either party needs to replace their RSA keys in the future). 1. The host uses SCM function C620 to generate a general-purpose RSA key pair. This function is called with the size of the modulus set to 32 8-byte blocks and the public key exponent set to 65537. 2. The host sends the host’s public key to the manufacturer in a secure offline message (encrypted with PGP, for example). 3. The host stores the host’s public key for sending to ATMs (see F.5.3). 4. The host stores the host’s encrypted secret key for signing ATM master keys (see F.5.4). 5. The manufacturer signs the host’s public key with the manufacturer’s secret key, and returns the signature in a secure offline message (encrypted with PGP, for example), along with the manufacturer’s public key. 6. The host appends the fixed exponent 65537 to the manufacturer’s public key and stores it for checking the signature of EPP public keys (see F.5.3). 7. The host stores the signed host’s public key for sending to ATMs (see F.5.3). F.5.2 Authentication by Host of ATM’s EPP Serial Number Host NCR NDC+ ATM Send EPP serial no. APCA2000 LOADPUBLIC- NDC+ C6B0 SN-EPP Extended Encryption Key Load ‘F’ message Encryptor Initialisation Data ‘1’ message (SN-EPP) * SK-NCR SN-EPP (SN-EPP) * SK-NCR PK-NCR 41 Figure 2 Authentication by Host of ATM’s EPP Serial Number IAC CODE SET VOLUME 4 - DEVICE REQUIREMENTS AND CRYPTOGRAPHIC MANAGEMENT ANNEXURE F. INTRODUCTION TO DEVICE SUPPORT AND SCM FUNCTIONALITY Australian Payments Network Limited [ABN 12 055 136 519] 32 1. The host requests the serial number of the ATM’s EPP using an Extended Encryption Key Load Message (Message Class 3, Message Sub-class 4) with Modifier ‘F’ - ‘Send EPP serial number and signature’. 2. The ATM returns the EPP’s serial number and its signature, which were loaded into the EPP during manufacture. They are sent in an Encryptor Initialisation Data message (Message Class 2, Message Sub-class 3) with Information Identifier ‘1’ - ‘EPP serial number and signature’. 3. There is no function in
```

