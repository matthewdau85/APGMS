# File: chunk_003028.txt (part 1 of 1)
```
to provide supplemental information. Information provided here does not replace or supersede requirements in any PCI SSC Standard. 52 Figure 10 – Partially Outsourced (JavaScript-Generated Form) Payment Flow 1. The cardholder browses AutoRental’s website, filling a shopping basket before reaching the payment page. 2. The creation of AutoRental’s payment page includes building a payment form through JavaScript (received from the PSP web server) in the customer’s web browser. 3. The customer enters all CHD into this JavaScript-generated payment form, which is submitted directly to the XYZ PSP Co., who is then responsible for handling the payment functions. 4. This link shows communication between the website and the Microsoft SQL Server. Although no CHD is submitted to the AutoRental website, the payment page and form are generated per instructions from the AutoRental website. This is different from Case Study Two because here the merchant’s website produces some or all of the web page that is used to accept payment data and then passes it directly to the third-party payment processor. In this implementation, the customer never leaves the merchant’s website. For merchants eligible to validate PCI DSS compliance via self-assessment, SAQ A-EP is applicable to outsourced e-commerce environments. Merchants are responsible for some or all elements in the payment page used to collect cardholder data and then pass it to a PCI DSS compliant payment service provider. For merchants with such implementations that are required to validate PCI DSS compliance via an onsite assessment and a Report on Compliance (ROC), SAQ A-EP can be used as a reference for applicable PCI DSS requirements. Information Supplement • Best Practices for Securing E-commerce • April 2017 The intent of this document is to provide supplemental information. Information provided here does not replace or supersede requirements in any PCI SSC Standard. 53 6.4 Case Study Four: Merchant Managed (API) Case Introduction LensInc is an e-commerce retailer offering affordable monthly prescription lenses. Due to LensInc being a pure e-commerce business with high transaction volumes, the payment functions integrate with an API to provide failover of payment service providers (PSP), should a payment transaction fail a secondary PSP can be tried. Description of Environment The hosting and e-commerce platform (website) is fully managed and maintained by LensInc staff within BigGuy Cloud Solution to provide a highly resilient infrastructure capable of dynamically increasing service capacity when required. BigGuy security groups are used to provide firewalling features along with BWS WAF (Web Application Firewalling) services to provide public-facing web application defenses. BigGuy Relational Database Services (BigGuy RDS) is used as the backend database for the web server on an internal network zone. The front-end web server utilizes Apache web server running PHP within a demilitarized zone (DMZ). A payment page and payment form are generated by the LensInc website. CHD is submitted to the LensInc web server, where it is then submitted to one of the PSPs for authorization and settlement through an API call to the PSP. Encrypted CHD is stored in LensInc’s backend database to provide easy checkout options where customers only need to provide the card verification value (CVV2/CVC2/CAV2/CID). Payment Flow The following diagram depicts the customer journey and cardholder data flow for an organization using an API implementation with a payment service provider for its e-commerce platform. Information Supplement • Best Practices for Securing E-commerce • April 2017 The intent of this document is to provide supplemental information. Information provided here does not replace or supersede requirements in any PCI SSC Standard. 54 Figure 11 – Merchant-managed (API) Payment Flow 1. The user browses LensInc’s website, filling a shopping basket and browsing to the payment page, issued by LensInc’s website. 2. The customer enters all CHD into the LensInc generated payment form, which is submitted directly to the LensInc web server. 3. The LensInc web server stores the CHD (PAN Only) before submitting the information (including the card verification value) to the Level 1 Compliant Payment Service Provider, XYZ PSP Co., through an API. This link shows communication between the website and the BigGuy RDS server, where CHD is stored (encrypted CHD storage, no sensitive authentication data). For merchants eligible to validate PCI DSS compliance via self-assessment, SAQ D is applicable in this scenario. The payment brands or the merchant’s acquirer may determine the merchant must complete a Report on Compliance (ROC) instead of SAQ D. Information Supplement • Best Practices for Securing E-commerce • April 2017 The intent of this document is to provide supplemental information. Information provided here does not replace or supersede requirements in any PCI SSC Standard. 55 7 Best Practices In addition to meeting the PCI DSS requirements applicable to a specific merchant e-commerce implementation, e-commerce merchants should consider implementing the additional PCI DSS requirements and some or all of the security best practices noted in this section. 7.1 Know the Location of all Your Cardholder Data Data-flow diagrams provide an important aid to understanding the scope of the cardholder data environment by showing the actual flow of cardholder data as it is being transmitted across various networks and systems (PCI DSS Requirement 1.1.3). Periodic review will ensure accuracy as changes to the environment may occur. Data-discovery software may help a merchant find any unencrypted PANs in the environment. A well-designed data flow diagram will:  Identify each system involved in the storing, processing and transmission of cardholder data (CHD).  Identify any system connected to the systems that store, process,
```

