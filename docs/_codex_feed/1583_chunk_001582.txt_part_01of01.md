# File: chunk_001582.txt (part 1 of 1)
```
structure Success? Is Employer and at least one Employee Message valid? Transform and Process Employer Message in Backend System Has Employer Message been processed OK? Validate all Logical Documents (Employer and all Employee Messages) against schema Transform and process All Employee Message messages in Backend BMS polls for response – before it is there Response not available yet Pull SBR for the response Get exception from SBR indicating that response is not available yet 1 2 3 4 5 9 8 7 15 14 13 11 10 Return Channel Validation Results for Employer & Employee Messages as well as Backend results for Employer Message 12 Explanation of steps Initial Submission 1. Client BMS prepares payload for the payroll event message (can be initiated by Employer, Intermediary, Payroll Provider. Alternative scenario - investment is being made to ensure SBR2 is always available, but it would be prudent for DSPs to anticipate potential for problems getting through to SBR 2. Therefore they should be prepared to hold lodgments until they can get through. 2. SBR 2 receives the payroll event, verifies the AUSKey, stores the payload. Very large lodgements may take longer to upload. This process will take as long as it takes. SBR 2 has been built to receive files of more than 200 K employees, which is more than enough to cater for any employer. 3. As per ebMS3, a technical receipt is returned to DSP. At this point the ATO has “caught the file” and will be able to process the lodgement. Alternative scenario if unsuccessful - technical exceptions are returned (e.g. unintelligible soap header ??timeout??) to the client BMS. 4. BMS will receive the technical receipt. Steps performed in ATO when message is received 5. ATO checks the message for compliance with the SBR ebMS3 structure, e.g. message integrity check , the specified agency, service and/or action values 6. ATO checks Authentication and Authorisation for the payroll lodgment. Authorisations are stored recorded in AM. Alternative scenario if unsuccessful – authorisation failed – ATO prepares validation report with authorisation or system error and makes it available for the pull by the client BMS from SBR ebMS3. This lodgement has not been rejected so it will need to be fixed and re-submitted. 7 . The Employer & Employee Payroll Event logical documents are split apart and validated against published XSD. 8 & 9. “Channel validation” is performed against the Employer Payroll Event & Employee Payroll Event messages. Channel validation applies business rules that go beyond schema validation, includes cross message checks, but does not have access to backend database Alternative scenario if unsuccessful – Parent validation failed and/or all Children failed validation – ATO prepares validation report with all validation error(s) and makes it available for the pull by the client BMS from SBR ebMS3. 10. If Employer Payroll Event (Parent) validation was successful and at least one valid Employee Payroll Event (Child) exists then parent data is transformed and sent to ATO Backend. The parent message should be processed within seconds. It will be processed with a lower quality of service than ATO Online traffic, but higher than other Employee Payroll Events. Alternative scenario if unsuccessful – If backend processing of parent returns errors – ATO prepares validation report for the pull by the client BMS from SBR ebMS3. This lodgement has been rejected so it will need to be fixed and re-submitted. 11. ATO prepares list of any channel validation errors (including schema exceptions or deeper channel validation rules) for the DSP to pull. 12. All Child messages that have passed channel validation will be forwarded to ATO Backend system processing as fire & forget. Given this has passed channel validation it is expected backend processing will proceed without further hiccup. This backend processing includes Identity Matching (confirming we can know who the employee is). If this fails then the employee payroll event details will be processed but will not appear on ATO Online as we can’t establish this link. BMS polls for response – before it is there 13. BMS software waits the prescribed period, then attempts to pull the validation report corresponding to the message id. 14. ATO receives the pull request, looks for the validation report. If it is not yet available it doesn't find one so it replies with (EBMS:0006). 15. BMS software receives the info that response is not found and further waits the prescribed period before re-attempting to pull the result. BMS polls for response – after it is there 16. BMS software waits the prescribed period, then attempts to pull the validation report corresponding to the message id. 17. ATO receives the pull request, looks for the validation report. The SBR 2 channel verifies the AUSKey, finds the response and returns it to the BMS. 18. The BMS receives the payroll event response. If the validation report doesn’t contain any errors the process of submitting payroll event is successfully completed, no further actions are required. Alternative scenarios: a. Authentication and authorisation errors are described after step 8. b. Parent has error or all children have errors are described after step 9. c. If Parent is successful but any employees payroll messages have errors these will need to be re-reported as per error handling framework, if this employee is not going to be reported next period or if has been finalised for the year, that record will need to be fixed and a payroll
```

