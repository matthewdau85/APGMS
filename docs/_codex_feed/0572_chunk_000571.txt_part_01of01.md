# File: chunk_000571.txt (part 1 of 1)
```
been removed from the AusPayNet Approved Devices List. Refer to the list managed by the Approved Standards Entity. A.15. HSMs approved under PCI PTS HSM may include a global setting (commonly called PCI mode) where all HSM functionality complies with PCI requirements. Does compliance with the IAC Code Set require the HSM to operate in PCI mode? No, the Code Set requires only that cryptographic operations used for IAC payments comply with the Code Set. The use of PCI mode is encouraged, however is not required for compliance of AusPayNet requirements. If PCI mode is disabled, other HSM security options, including the option(s) enforcing minimum key length(s), shall be appropriately configured in compliance with all applicable requirements of the IAC Code Set. A.16. Listings for PCI approved HSMs include the hardware, firmware and application (if applicable) version identifiers for the approved product. Must the hardware, firmware and application (if applicable) version numbers from the listing exactly match the deployed HSMs? Hardware version must match the PCI listing. Firmware and application versions shall match the PCI listing, except when the difference is introduced by ‘non-PCI mode’ supported on certain HSMs. HSMs in non-PCI mode must be configured securely in compliance with all applicable requirements of the IAC Code Set. The assessor shall validate all other HSM security options being appropriately configured and examine other supporting evidence (e.g. key cryptograms demonstrating key lengths). A.17. Does the IAC Code Set require AS2805.2 or AS2805.12 conformant message structure for card-present transactions? No, other messaging formats are acceptable. The security and cryptography principles described in the Code Set shall be met, regardless of the messaging format used. A.18. Does TLS encryption address the privacy of communications requirement? There are two answers depending upon the type of communication link For Terminal to Acquirer links using TCP/IP, Clause 3.2.4 in Code Set Vol 3 requires transport level message encipherment in addition to end-to-end financial message encipherment. TCP/IP Terminals therefore require TLS (or equivalent transport layer encryption) plus a second layer of encryption (e.g. AS2805.9 privacy encryption) to meet the Code Set obligations. During Interchange, IAC Code Set Vol 3, Clause 2.4.9 specifically allows privacy of communications to be met with transport level data encryption, subject to a series of conditions. Where the combination of TLS design, key management practices and configuration settings addresses all applicable conditions, then TLS can be used to comply with Clause 2.4.4 – Privacy of Communication (for IAC Interchange Lines). A.19. Can JSON Web Encryption (JWE) be used as a replacement for AS2805.9 compliant encryption for the privacy protection of payment messages used by TCP/IP terminals? Yes, JWE can be classified as a type of point-to-point communications technique as defined in AS2805.9. The two layers of cryptographic protection required by Code Set Vol 3, 3.2.4 for TCP/IP terminals can be addressed by using TLS together with JWE. Not all options within JWE comply with Code Set requirements. For example, PBES2 password based key derivation systems do not typically meet the privacy requirements and cannot be used in an IAC compliant system. A.20. Can JWE be used as the primary protection for session keys during transmission? The code set includes the following requirements applicable to session key distribution - Session keys are to be encrypted using the CBC mode of operation - All PIN and MAC cryptographic functions (including encryption and decryption of session keys) must be performed within an approved device. - A key (including KEK and session key) is used only for a single designated purpose If a system using JWE to transport session keys can be shown to meet all applicable Code Set requirements, then it may be used for session key exchange. A.21. AS2805.2 messages are known to comply with applicable IAC Code Set requirements. How is compliance of non-AS2805.2 messaging formats assessed? Acquirers and Issuers are responsible for ensuring communications of card payment messages follow IAC Code Set requirements. The annual audit shall consider whether the communications mechanism in use complies with all applicable IAC Code Set requirements. Code implementing payment messages is commonly included in the application layer, executing on either a payment terminal or a host server. This code is outside the scope of the device approval program therefore using an approved device provides no guarantee on whether the messaging format complies with IAC rules. A.22. Can RESTful APIs be used for PIN transmission? Code Set Vol 3, clause 2.3.1 requires plaintext PINs and related plaintext key material to be handled exclusively within approved devices. TLS and RESTful APIs are commonly handled by general purpose computers which are not approved devices and are therefore not suitable for handling of plaintext PIN material. A PIN may only be transmitted as an encrypted PIN block output from an approved device. Clause 2.2 (e) requires online PIN blocks to comply with ISO 9564-1, excluding Format 1 and 2 but there is no restriction on the mechanism for transfer of encrypted PIN blocks. A RESTful API may be used to transfer an encrypted PIN block but not a plaintext PIN block or plaintext PIN data. B. Issuer Audit FAQ B.1. Is PIN change within an Issuer owned environment in scope? Yes, PIN change within an Issuer’s environment is in scope as compliance with ISO 9564-1 is mandatory for all PIN related activities (see clause 2.1 of Volume 2). B.2. Are issuing PIN activities outside of Interchange in scope of the IAC annual audit?
```

