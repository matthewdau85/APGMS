# File: chunk_000560.txt (part 1 of 1)
```
Electronic funds transfer - Requirements for interfaces - Key management - Session keys - Terminal to acquirer. 56 Amended effective 20/8/18, version 007 r&p 001.18 IAC CODE SET VOLUME 4 - DEVICE REQUIREMENTS AND CRYPTOGRAPHIC MANAGEMENT ANNEXURE F. INTRODUCTION TO DEVICE SUPPORT AND SCM FUNCTIONALITY Australian Payments Network Limited [ABN 12 055 136 519] 27 9. AS 2805.6.5.3-2004 Electronic funds transfer - Requirements for interfaces - Key management - TCU initialization - Asymmetric. 10. NCR NDC+ Programmer’s Reference Manual. F.3 Overview Section F.4 describes the key specifiers which the AusPayNet SCMs use to manage keys with different lengths and attributes. It also describes the key variants that are used. Section F.5 shows how AusPayNet SCM functions can be used to perform 3DES ATM key management with double-length keys, MACing, and remote initialisation. The AusPayNet SCM functions currently only provide support for NCR’s NDC+ 3DES ATMs. Details of other ATM manufacturer’s 3DES functionality are covered. Section F.6 shows how AusPayNet SCM functions can be used to perform 3DES POS key management (double-length session keys) with remote initialisation. The scheme described in section F.6 is AS 2805.6.4 key management (session keys) and AS 2805.6.5.3 remote initialisation. The AusPayNet SCM also provides 3DES functions to support AS 2805.6.2 key management (transaction keys). This is not covered in this document. For both ATM and EFTPOS Terminals, there are associated new or upgraded remote initialisation standards and associated SCM functions, which interface with the 3DES session key management functions. The IAC Manual should be consulted to determine the appropriate key lengths to be used when implementing any remote key initialisation scheme.57 For ATM devices, section F.5.6 describes how double-length master keys can be loaded manually instead of by remote initialisation. For EFTPOS Terminals, section F.6.5 describes how it is possible to combine 3DES session key management with remote initialisation using the existing 512- bit RSA keys.5859 F.4 Key Specifiers and Variants The AusPayNet SCM specification introduces a new data structure: the key specifier. A key specifier allows various attributes to be associated with a key: • key length: single, double, triple, etc.; • keyblock encipherment algorithm: DEA, AES, etc.; 57 Amended effective 20/8/18, version 007 r&p 001.18 58 It is a challenge for POS Terminals with 8-bit hardware to perform signing and ciphering with 1024-bit keys. It is not unknown for a Terminal to take 11-12 minutes to perform this calculation with 512-bit keys after being sent the sponsor’s public key (see F.6.4). 59 Amended effective 20/8/18, version 007 r&p 001.18 IAC CODE SET VOLUME 4 - DEVICE REQUIREMENTS AND CRYPTOGRAPHIC MANAGEMENT ANNEXURE F. INTRODUCTION TO DEVICE SUPPORT AND SCM FUNCTIONALITY Australian Payments Network Limited [ABN 12 055 136 519] 28 • keyblock encipherment mode: ECB, CBC, etc. ; • storage mode: host or SCM. These attributes are encoded as different hexadecimal values of a one-byte key specifier format code. Thus format code 21, for example, specifies a key with the following attributes: • key length: double (128-bit); • keyblock encipherment algorithm: DEA; • keyblock encipherment mode: CBC; • storage mode: host (because this format includes an index of the KM under which the key is enciphered for storage on the host. Many AusPayNet SCM functions allow more than one key specifier format to be used in the request or the response. The following key specifier formats are applicable to the host-stored keys used for ATM and EFTPOS Terminal key management:60 Format 21 DEA CBC Enciphered key - 128-bit with KM index Length Attrib Content Description 1 H 21 Format Code 1 X i KM index (Range 00-FF) 16 X eKMi(K) Enciphered key Format 23 DEA ECB Enciphered key - 128-bit with KM index Length Attrib Content Description 1 H 23 Format Code 1 X i KM index (Range 00-FF) 16 X eKMi(K) Enciphered key Format 31 DEA CBC Enciphered key - 128-bit Length Attrib Content Description 1 H 31 Format Code 16 X eKEK(K) Enciphered key 60 Amended effective 20/8/18, version 007 r&p 001.18 IAC CODE SET VOLUME 4 - DEVICE REQUIREMENTS AND CRYPTOGRAPHIC MANAGEMENT ANNEXURE F. INTRODUCTION TO DEVICE SUPPORT AND SCM FUNCTIONALITY Australian Payments Network Limited [ABN 12 055 136 519] 29 Format 41 Cleartext key - DEA 2 Length Attrib Content Description 1 H 41 Format Code 1 X n Number (n) of 8-byte blocks in modulus 16*n X PK Clear text DEA 2 public key Format 42 Enciphered key - DEA 2 with KM index Length Attrib Content Description 1 H 42 Format Code 1 X n Number (n) of 8-byte blocks in modulus 1 X i KM index (Range 00-FF) 16*n X eKMi(PK) or eKMi(SK) DEA CBC Enciphered DEA 2 key. Either the public key or the private key. Each SCM function implicitly requires keyblocks in a predetermined format. In an SCM Spec function, the key specifier is preceded by a length prefix, which adds one or more bytes to each of the above formats. The value of the length prefix does not include its own length. It is not necessary to store or transmit the length prefix, as its value is implied by the format code. The lengths of each of the above key specifiers are as follows: Length Format code Key specifier 21 DEA CBC Enciphered key - 128-bit with KM index 18 23 DEA ECB Enciphered key - 128-bit with KM index 17 31 DEA CBC Enciphered key - 128-bit 16n + 2 41 Cleartext DEA 2 public
```

